"use strict";!function(){function e(e){if(!(e.origin.indexOf(o)<0&&e.origin.indexOf("dowjones.com")<0)&&"string"==typeof e.data&&"DJSSO"===e.data.substr(0,5))try{var t=e.data.split("|")[2],n=JSON.parse(t);switch(n.name){case"iframe-done":c.onIframeCompleted.call(c,n.data.frameId)}}catch(a){console.error("event data not JSON",e)}}var t="https://accounts.dowjones.com",o=window.location.host.replace(/^.*?([\w\d\-]+\.[\w\d\:]+)\r?$/,"$1"),n="//accounts.",a="wsj.com,marketwatch.com,barrons.com",r=a?a.split(","):[],s="width:0;height:0;border:none",i=o.indexOf(":");i>-1&&(o=o.substr(0,i));var d=o,c={ssoSecondaryIframes:{},generateSsoIframes:function(e,t,n){for(var a=0;a<r.length;a++){var s=r[a].trim();if(o!==s){var i=(new Date).getTime(),d="iframe-rp-"+s+"-"+i,c=this.createIframe(d,s,t);this.ssoSecondaryIframes[d]=this.onIframeCompleted.bind(this),e.appendChild(c)}}},createIframe:function(e,o,a){var r=o.split(".")[0];"marketwatch"===r&&(r="mw");var i=document.createElement("iframe");i.setAttribute("id",e);var d=window.location.protocol+n+o,c=d+"/assets/secondary-rp-sync.html?iframe_id="+encodeURIComponent(e),m="",l=t.replace("dowjones.com",o);return m="logout"==a?l+"/auth/sso/logout?rr=off&url="+encodeURIComponent(c):l+"/auth/silent-login?target="+encodeURIComponent(c),i.setAttribute("src",m),i.setAttribute("style",s),i},onIframeCompleted:function(e){delete this.ssoSecondaryIframes[e],document.getElementsByTagName("body")[0].removeChild(document.getElementById(e))},clearIframes:function(){for(var e in this.ssoSecondaryIframes)this.ssoSecondaryIframes[e](e)}},m={getCookie:function(e,t){function o(e){return e.replace(/([.*+?\^${}()|\[\]\/\\])/g,"\\$1")}var n=t?t:document.cookie,a=n.match(RegExp("(?:^|;\\s*)"+o(e)+"=([^;]*)"));return a?a[1]:null},deleteCookie:function(e,t){t.cookie=e+"=; Domain=."+d+"; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}},l=(document.getElementsByTagName("body")[0],m.getCookie("run-sso")),u=m.getCookie("run-slo"),f=m.getCookie("djcs_route");l&&f?(m.deleteCookie("run-sso",document),c.generateSsoIframes(document.getElementsByTagName("body")[0],"login",f)):u&&f&&(m.deleteCookie("run-slo",document),c.generateSsoIframes(document.getElementsByTagName("body")[0],"logout",f)),window.postMessage&&(window.addEventListener?window.addEventListener("message",e,!1):window.attachEvent&&window.attachEvent("onmessage",e))}();